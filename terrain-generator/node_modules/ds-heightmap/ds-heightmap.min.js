!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).DsHeightmap=f()}}(function(){return function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}({1:[function(require,module,exports){"use strict";var average=require("./utils").average,fillArray=require("./utils").fillArray,makeValInRange=require("./utils").makeValInRange,posInArray=require("./utils").posInArray,VALUE_MIN=1,_data=[],_corners=[],_power=7,_corner=[1,1,1,1],_offset=-.2,_range=7,_rough=.8,_max=0,_initialAverage=0,_ds={init:function(r){(function(r,a){var n=Number.isInteger(r)?r:Number.parseInt(r);_power=n<0?2:12<n?12:n,_max=Math.pow(2,_power)+1,_offset="number"==typeof a.offset?makeValInRange(a.offset,-.9,.9):_offset,_range="number"==typeof a.range?makeValInRange(a.range,VALUE_MIN,a.range):_range,_rough="number"==typeof a.rough?makeValInRange(a.rough,.1,.9):_rough;var e=a.corner?fillArray(4,a.corner):Array(4).fill(null);_corner=e.map(function(r){return null===r?Math.random()*_range:makeValInRange(r,VALUE_MIN,_range)})})(r,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}),function(){_data=[],_corners=[[0,0],[_max-1,0],[_max-1,_max-1],[0,_max-1]],_initialAverage=average(_corner);for(var r=0;r<_max;++r)_data.push(Array(_max).fill(0));_corners.forEach(function(r,a){set.apply(void 0,function(r){if(Array.isArray(r)){for(var a=0,n=Array(r.length);a<r.length;a++)n[a]=r[a];return n}return Array.from(r)}(r).concat([_corner[a]]))})}()},run:function(){!function diamondSquare(r){var a=r/2;if(a<1)return _data;var n=void 0,e=void 0;for(e=a;e<_max;e+=r)for(n=a;n<_max;n+=r)notCorner(n,e)&&square(n,e,a);for(e=0;e<_max;e+=a)for(n=(e+a)%r;n<_max;n+=r)notCorner(n,e)&&diamond(n,e,a);diamondSquare(r/2)}(_max-1)},out:function(){return _data},gen:function(){return _ds.run(),_ds.out()},ds:function(r){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return _ds.init(r,a),_ds.gen()}};function get(r,a){return r<0||_max-1<r||a<0||_max-1<a?_initialAverage:_data[r][a]}function set(r,a,n){_data[r][a]=n}function square(r,a,n){set(r,a,getValue(average([get(r-n,a-n),get(r+n,a-n),get(r+n,a+n),get(r-n,a+n)]),n))}function diamond(r,a,n){set(r,a,getValue(average([get(r,a-n),get(r+n,a),get(r,a+n),get(r-n,a)]),n))}function getValue(r,a){return makeValInRange(Math.round(r+function(r,a){var n=((_range-VALUE_MIN)/2-(r-VALUE_MIN))/((_range-VALUE_MIN)/2),e=a/_max;return r*((.8*randomize(_offset,.8)+.2*randomize(function getSign(r){return 0===Math.abs(r)?getSign(Math.random()-.5):Math.abs(r)/r}(n)*_rough,.9))*randomize(e,.5)*4+(Math.random()-.5)*_rough*a*.02)}(r,a)),VALUE_MIN,_range)}function randomize(r,a){return r*(a+(1-a)*Math.random())}function notCorner(r,a){return 0!==r&&r!==_max-1&&0!==a&&a!==_max-1||!posInArray(r,a,_corners)}module.exports=_ds},{"./utils":2}],2:[function(require,module,exports){"use strict";var utils={average:function(r){return r.reduce(function(r,n){return r+n})/r.length},fillArray:function(r,n){return"number"==typeof i?Array(r).fill(n):Array.isArray(n)?n.length<r?n.concat(Array(r-n.length).fill(n[n.length-1])):n.length>r?n.slice(0,r):n:[1,1,1,1]},makeValInRange:function(r,n,e){var a=void 0,t=void 0;return(t=n<=e?(a=n,e):(a=e,n))<r?t:r<a?a:r},rgbToHex:function(r,n,e){return"#"+((1<<24)+(r<<16)+(n<<8)+e).toString(16).slice(1)},posInArray:function(r,n,e){return e.some(function(e,a,t){return e[0]===r&&e[1]===n})}};module.exports=utils},{}]},{},[1])(1)});